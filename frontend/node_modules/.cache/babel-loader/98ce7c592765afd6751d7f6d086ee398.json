{"ast":null,"code":"var __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\n\nimport uniq from 'lodash/uniq';\nimport { CRUD_GET_LIST_SUCCESS, CRUD_CREATE_SUCCESS } from '../../../../actions';\nimport { DELETE, DELETE_MANY } from '../../../../core';\nvar initialState = [];\n/**\n * List of the ids of the latest loaded page, regardless of params\n *\n * When loading the list for the first time, useListController grabs the ids\n * from the cachedRequests reducer (not this ids reducer). It's only when the user\n * changes page, sort, or filter, that the useListController hook uses the ids\n * reducer, so as to show the previous list of results while loading the new\n * list (instead of displaying a blank page each time the list params change).\n *\n * @see useListController\n *\n */\n\nvar idsReducer = function (previousState, action) {\n  if (previousState === void 0) {\n    previousState = initialState;\n  }\n\n  if (action.meta && action.meta.optimistic) {\n    if (action.meta.fetch === DELETE) {\n      var index = previousState.map(function (el) {\n        return el === action.payload.id;\n      }) // eslint-disable-line eqeqeq\n      .indexOf(true);\n\n      if (index === -1) {\n        return previousState;\n      }\n\n      return __spreadArray(__spreadArray([], previousState.slice(0, index), true), previousState.slice(index + 1), true);\n    }\n\n    if (action.meta.fetch === DELETE_MANY) {\n      var newState = previousState.filter(function (el) {\n        return !action.payload.ids.includes(el);\n      });\n      return newState;\n    }\n  }\n\n  switch (action.type) {\n    case CRUD_GET_LIST_SUCCESS:\n      return action.payload.data.map(function (_a) {\n        var id = _a.id;\n        return id;\n      });\n\n    case CRUD_CREATE_SUCCESS:\n      return uniq(__spreadArray([action.payload.data.id], previousState, true));\n\n    default:\n      return previousState;\n  }\n};\n\nexport default idsReducer;\nexport var getIds = function (state) {\n  return state;\n};","map":{"version":3,"names":["__spreadArray","to","from","pack","arguments","length","i","l","ar","Array","prototype","slice","call","concat","uniq","CRUD_GET_LIST_SUCCESS","CRUD_CREATE_SUCCESS","DELETE","DELETE_MANY","initialState","idsReducer","previousState","action","meta","optimistic","fetch","index","map","el","payload","id","indexOf","newState","filter","ids","includes","type","data","_a","getIds","state"],"sources":["/app/node_modules/ra-core/esm/reducer/admin/resource/list/ids.js"],"sourcesContent":["var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport uniq from 'lodash/uniq';\nimport { CRUD_GET_LIST_SUCCESS, CRUD_CREATE_SUCCESS, } from '../../../../actions';\nimport { DELETE, DELETE_MANY } from '../../../../core';\nvar initialState = [];\n/**\n * List of the ids of the latest loaded page, regardless of params\n *\n * When loading the list for the first time, useListController grabs the ids\n * from the cachedRequests reducer (not this ids reducer). It's only when the user\n * changes page, sort, or filter, that the useListController hook uses the ids\n * reducer, so as to show the previous list of results while loading the new\n * list (instead of displaying a blank page each time the list params change).\n *\n * @see useListController\n *\n */\nvar idsReducer = function (previousState, action) {\n    if (previousState === void 0) { previousState = initialState; }\n    if (action.meta && action.meta.optimistic) {\n        if (action.meta.fetch === DELETE) {\n            var index = previousState\n                .map(function (el) { return el === action.payload.id; }) // eslint-disable-line eqeqeq\n                .indexOf(true);\n            if (index === -1) {\n                return previousState;\n            }\n            return __spreadArray(__spreadArray([], previousState.slice(0, index), true), previousState.slice(index + 1), true);\n        }\n        if (action.meta.fetch === DELETE_MANY) {\n            var newState = previousState.filter(function (el) { return !action.payload.ids.includes(el); });\n            return newState;\n        }\n    }\n    switch (action.type) {\n        case CRUD_GET_LIST_SUCCESS:\n            return action.payload.data.map(function (_a) {\n                var id = _a.id;\n                return id;\n            });\n        case CRUD_CREATE_SUCCESS:\n            return uniq(__spreadArray([action.payload.data.id], previousState, true));\n        default:\n            return previousState;\n    }\n};\nexport default idsReducer;\nexport var getIds = function (state) { return state; };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}