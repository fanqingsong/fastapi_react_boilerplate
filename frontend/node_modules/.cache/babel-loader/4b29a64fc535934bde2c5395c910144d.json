{"ast":null,"code":"import { useState, useCallback } from 'react';\nimport { useDelete } from '../../dataProvider';\nimport { CRUD_DELETE } from '../../actions';\nimport { useRefresh, useNotify, useRedirect } from '../../sideEffect';\nimport { useResourceContext } from '../../core';\n/**\n * Prepare a set of callbacks for a delete button guarded by confirmation dialog\n *\n * @example\n *\n * const DeleteButton = ({\n *     resource,\n *     record,\n *     basePath,\n *     redirect,\n *     onClick,\n *     ...rest\n * }) => {\n *     const {\n *         open,\n *         loading,\n *         handleDialogOpen,\n *         handleDialogClose,\n *         handleDelete,\n *     } = useDeleteWithConfirmController({\n *         resource,\n *         record,\n *         redirect,\n *         basePath,\n *         onClick,\n *     });\n *\n *     return (\n *         <Fragment>\n *             <Button\n *                 onClick={handleDialogOpen}\n *                 label=\"ra.action.delete\"\n *                 {...rest}\n *             >\n *                 {icon}\n *             </Button>\n *             <Confirm\n *                 isOpen={open}\n *                 loading={loading}\n *                 title=\"ra.message.delete_title\"\n *                 content=\"ra.message.delete_content\"\n *                 translateOptions={{\n *                     name: resource,\n *                     id: record.id,\n *                 }}\n *                 onConfirm={handleDelete}\n *                 onClose={handleDialogClose}\n *             />\n *         </Fragment>\n *     );\n * };\n */\n\nvar useDeleteWithConfirmController = function (props) {\n  var record = props.record,\n      redirectTo = props.redirect,\n      basePath = props.basePath,\n      mutationMode = props.mutationMode,\n      onClick = props.onClick,\n      onSuccess = props.onSuccess,\n      onFailure = props.onFailure;\n  var resource = useResourceContext(props);\n\n  var _a = useState(false),\n      open = _a[0],\n      setOpen = _a[1];\n\n  var notify = useNotify();\n  var redirect = useRedirect();\n  var refresh = useRefresh();\n\n  var _b = useDelete(resource, null, null, {\n    action: CRUD_DELETE,\n    onSuccess: function (response) {\n      setOpen(false);\n\n      if (onSuccess === undefined) {\n        notify('ra.notification.deleted', {\n          type: 'info',\n          messageArgs: {\n            smart_count: 1\n          },\n          undoable: mutationMode === 'undoable'\n        });\n        redirect(redirectTo, basePath || \"/\" + resource);\n        refresh();\n      } else {\n        onSuccess(response);\n      }\n    },\n    onFailure: function (error) {\n      setOpen(false);\n\n      if (onFailure === undefined) {\n        notify(typeof error === 'string' ? error : error.message || 'ra.notification.http_error', {\n          type: 'warning',\n          messageArgs: {\n            _: typeof error === 'string' ? error : error && error.message ? error.message : undefined\n          }\n        });\n        refresh();\n      } else {\n        onFailure(error);\n      }\n    },\n    mutationMode: mutationMode\n  }),\n      deleteOne = _b[0],\n      loading = _b[1].loading;\n\n  var handleDialogOpen = function (e) {\n    setOpen(true);\n    e.stopPropagation();\n  };\n\n  var handleDialogClose = function (e) {\n    setOpen(false);\n    e.stopPropagation();\n  };\n\n  var handleDelete = useCallback(function (event) {\n    event.stopPropagation();\n    deleteOne({\n      payload: {\n        id: record.id,\n        previousData: record\n      }\n    });\n\n    if (typeof onClick === 'function') {\n      onClick(event);\n    }\n  }, [deleteOne, onClick, record]);\n  return {\n    open: open,\n    loading: loading,\n    handleDialogOpen: handleDialogOpen,\n    handleDialogClose: handleDialogClose,\n    handleDelete: handleDelete\n  };\n};\n\nexport default useDeleteWithConfirmController;","map":{"version":3,"names":["useState","useCallback","useDelete","CRUD_DELETE","useRefresh","useNotify","useRedirect","useResourceContext","useDeleteWithConfirmController","props","record","redirectTo","redirect","basePath","mutationMode","onClick","onSuccess","onFailure","resource","_a","open","setOpen","notify","refresh","_b","action","response","undefined","type","messageArgs","smart_count","undoable","error","message","_","deleteOne","loading","handleDialogOpen","e","stopPropagation","handleDialogClose","handleDelete","event","payload","id","previousData"],"sources":["/app/node_modules/ra-core/esm/controller/button/useDeleteWithConfirmController.js"],"sourcesContent":["import { useState, useCallback, } from 'react';\nimport { useDelete } from '../../dataProvider';\nimport { CRUD_DELETE } from '../../actions';\nimport { useRefresh, useNotify, useRedirect, } from '../../sideEffect';\nimport { useResourceContext } from '../../core';\n/**\n * Prepare a set of callbacks for a delete button guarded by confirmation dialog\n *\n * @example\n *\n * const DeleteButton = ({\n *     resource,\n *     record,\n *     basePath,\n *     redirect,\n *     onClick,\n *     ...rest\n * }) => {\n *     const {\n *         open,\n *         loading,\n *         handleDialogOpen,\n *         handleDialogClose,\n *         handleDelete,\n *     } = useDeleteWithConfirmController({\n *         resource,\n *         record,\n *         redirect,\n *         basePath,\n *         onClick,\n *     });\n *\n *     return (\n *         <Fragment>\n *             <Button\n *                 onClick={handleDialogOpen}\n *                 label=\"ra.action.delete\"\n *                 {...rest}\n *             >\n *                 {icon}\n *             </Button>\n *             <Confirm\n *                 isOpen={open}\n *                 loading={loading}\n *                 title=\"ra.message.delete_title\"\n *                 content=\"ra.message.delete_content\"\n *                 translateOptions={{\n *                     name: resource,\n *                     id: record.id,\n *                 }}\n *                 onConfirm={handleDelete}\n *                 onClose={handleDialogClose}\n *             />\n *         </Fragment>\n *     );\n * };\n */\nvar useDeleteWithConfirmController = function (props) {\n    var record = props.record, redirectTo = props.redirect, basePath = props.basePath, mutationMode = props.mutationMode, onClick = props.onClick, onSuccess = props.onSuccess, onFailure = props.onFailure;\n    var resource = useResourceContext(props);\n    var _a = useState(false), open = _a[0], setOpen = _a[1];\n    var notify = useNotify();\n    var redirect = useRedirect();\n    var refresh = useRefresh();\n    var _b = useDelete(resource, null, null, {\n        action: CRUD_DELETE,\n        onSuccess: function (response) {\n            setOpen(false);\n            if (onSuccess === undefined) {\n                notify('ra.notification.deleted', {\n                    type: 'info',\n                    messageArgs: { smart_count: 1 },\n                    undoable: mutationMode === 'undoable',\n                });\n                redirect(redirectTo, basePath || \"/\" + resource);\n                refresh();\n            }\n            else {\n                onSuccess(response);\n            }\n        },\n        onFailure: function (error) {\n            setOpen(false);\n            if (onFailure === undefined) {\n                notify(typeof error === 'string'\n                    ? error\n                    : error.message || 'ra.notification.http_error', {\n                    type: 'warning',\n                    messageArgs: {\n                        _: typeof error === 'string'\n                            ? error\n                            : error && error.message\n                                ? error.message\n                                : undefined,\n                    },\n                });\n                refresh();\n            }\n            else {\n                onFailure(error);\n            }\n        },\n        mutationMode: mutationMode,\n    }), deleteOne = _b[0], loading = _b[1].loading;\n    var handleDialogOpen = function (e) {\n        setOpen(true);\n        e.stopPropagation();\n    };\n    var handleDialogClose = function (e) {\n        setOpen(false);\n        e.stopPropagation();\n    };\n    var handleDelete = useCallback(function (event) {\n        event.stopPropagation();\n        deleteOne({\n            payload: { id: record.id, previousData: record },\n        });\n        if (typeof onClick === 'function') {\n            onClick(event);\n        }\n    }, [deleteOne, onClick, record]);\n    return { open: open, loading: loading, handleDialogOpen: handleDialogOpen, handleDialogClose: handleDialogClose, handleDelete: handleDelete };\n};\nexport default useDeleteWithConfirmController;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}