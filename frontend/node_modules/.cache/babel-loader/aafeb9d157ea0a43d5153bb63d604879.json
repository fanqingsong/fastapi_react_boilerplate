{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\n\nimport HttpError from './HttpError';\nimport { stringify } from 'query-string';\nexport var createHeadersFromOptions = function (options) {\n  var requestHeaders = options.headers || new Headers({\n    Accept: 'application/json'\n  });\n\n  if (!requestHeaders.has('Content-Type') && !(options && (!options.method || options.method === 'GET')) && !(options && options.body && options.body instanceof FormData)) {\n    requestHeaders.set('Content-Type', 'application/json');\n  }\n\n  if (options.user && options.user.authenticated && options.user.token) {\n    requestHeaders.set('Authorization', options.user.token);\n  }\n\n  return requestHeaders;\n};\nexport var fetchJson = function (url, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var requestHeaders = createHeadersFromOptions(options);\n  return fetch(url, __assign(__assign({}, options), {\n    headers: requestHeaders\n  })).then(function (response) {\n    return response.text().then(function (text) {\n      return {\n        status: response.status,\n        statusText: response.statusText,\n        headers: response.headers,\n        body: text\n      };\n    });\n  }).then(function (_a) {\n    var status = _a.status,\n        statusText = _a.statusText,\n        headers = _a.headers,\n        body = _a.body;\n    var json;\n\n    try {\n      json = JSON.parse(body);\n    } catch (e) {// not json, no big deal\n    }\n\n    if (status < 200 || status >= 300) {\n      return Promise.reject(new HttpError(json && json.message || statusText, status, json));\n    }\n\n    return Promise.resolve({\n      status: status,\n      headers: headers,\n      body: body,\n      json: json\n    });\n  });\n};\nexport var queryParameters = stringify;\n\nvar isValidObject = function (value) {\n  if (!value) {\n    return false;\n  }\n\n  var isArray = Array.isArray(value);\n  var isBuffer = typeof Buffer !== 'undefined' && Buffer.isBuffer(value);\n  var isObject = Object.prototype.toString.call(value) === '[object Object]';\n  var hasKeys = !!Object.keys(value).length;\n  return !isArray && !isBuffer && isObject && hasKeys;\n};\n\nexport var flattenObject = function (value, path) {\n  var _a;\n\n  if (path === void 0) {\n    path = [];\n  }\n\n  if (isValidObject(value)) {\n    return Object.assign.apply(Object, __spreadArray([{}], Object.keys(value).map(function (key) {\n      return flattenObject(value[key], path.concat([key]));\n    }), false));\n  } else {\n    return path.length ? (_a = {}, _a[path.join('.')] = value, _a) : value;\n  }\n};","map":{"version":3,"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__spreadArray","to","from","pack","l","ar","Array","slice","concat","HttpError","stringify","createHeadersFromOptions","options","requestHeaders","headers","Headers","Accept","has","method","body","FormData","set","user","authenticated","token","fetchJson","url","fetch","then","response","text","status","statusText","_a","json","JSON","parse","e","Promise","reject","message","resolve","queryParameters","isValidObject","value","isArray","isBuffer","Buffer","isObject","toString","hasKeys","keys","flattenObject","path","map","key","join"],"sources":["/home/lightsong/workspace/freact/frontend/node_modules/ra-core/esm/dataProvider/fetch.js"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport HttpError from './HttpError';\nimport { stringify } from 'query-string';\nexport var createHeadersFromOptions = function (options) {\n    var requestHeaders = (options.headers ||\n        new Headers({\n            Accept: 'application/json',\n        }));\n    if (!requestHeaders.has('Content-Type') &&\n        !(options && (!options.method || options.method === 'GET')) &&\n        !(options && options.body && options.body instanceof FormData)) {\n        requestHeaders.set('Content-Type', 'application/json');\n    }\n    if (options.user && options.user.authenticated && options.user.token) {\n        requestHeaders.set('Authorization', options.user.token);\n    }\n    return requestHeaders;\n};\nexport var fetchJson = function (url, options) {\n    if (options === void 0) { options = {}; }\n    var requestHeaders = createHeadersFromOptions(options);\n    return fetch(url, __assign(__assign({}, options), { headers: requestHeaders }))\n        .then(function (response) {\n        return response.text().then(function (text) { return ({\n            status: response.status,\n            statusText: response.statusText,\n            headers: response.headers,\n            body: text,\n        }); });\n    })\n        .then(function (_a) {\n        var status = _a.status, statusText = _a.statusText, headers = _a.headers, body = _a.body;\n        var json;\n        try {\n            json = JSON.parse(body);\n        }\n        catch (e) {\n            // not json, no big deal\n        }\n        if (status < 200 || status >= 300) {\n            return Promise.reject(new HttpError((json && json.message) || statusText, status, json));\n        }\n        return Promise.resolve({ status: status, headers: headers, body: body, json: json });\n    });\n};\nexport var queryParameters = stringify;\nvar isValidObject = function (value) {\n    if (!value) {\n        return false;\n    }\n    var isArray = Array.isArray(value);\n    var isBuffer = typeof Buffer !== 'undefined' && Buffer.isBuffer(value);\n    var isObject = Object.prototype.toString.call(value) === '[object Object]';\n    var hasKeys = !!Object.keys(value).length;\n    return !isArray && !isBuffer && isObject && hasKeys;\n};\nexport var flattenObject = function (value, path) {\n    var _a;\n    if (path === void 0) { path = []; }\n    if (isValidObject(value)) {\n        return Object.assign.apply(Object, __spreadArray([{}], Object.keys(value).map(function (key) {\n            return flattenObject(value[key], path.concat([key]));\n        }), false));\n    }\n    else {\n        return path.length ? (_a = {}, _a[path.join('.')] = value, _a) : value;\n    }\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}